// Copyright (c) 2022 Slack Technologies, Inc.

#import <Foundation/Foundation.h>

#import "BorderPanel.h"
#import "BorderView.h"

@implementation BorderPanel

- (id)initWithContentRect:(NSRect)contentRect
                styleMask:(NSWindowStyleMask)style
                  backing:(NSBackingStoreType)backingStoreType
                    defer:(BOOL)flag {
  self = [super initWithContentRect:contentRect
                          styleMask:style
                            backing:backingStoreType
                              defer:flag];
  [self setLevel:NSNormalWindowLevel];
  [self setHidesOnDeactivate:false];
  [self setHasShadow:false];
  [self center];
  [self setMovableByWindowBackground:false];
  [self setShowsToolbarButton:false];
  [self setStyleMask:NSWindowStyleMaskNonactivatingPanel];
  [self setSharingType:NSWindowSharingNone];

  BorderView* view = [[BorderView alloc] init];
  [view setFrame:NSZeroRect];
  [self setContentView:view];

  return self;
}

- (BOOL)canBecomeMainWindow {
  return true;
}

- (BOOL)isReleasedWhenClosed {
  return true;
}

- (void)makeKeyWindow {
  [super makeKeyWindow];
  [[NSApplication sharedApplication] addWindowsItem:self
                                              title:[self title]
                                           filename:false];
}

- (void)cancelOperation:(id)sender {
  // Override default behavior to prevent panel from closing
}

@end
